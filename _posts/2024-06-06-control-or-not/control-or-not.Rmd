---
title: "Control or not?"
description: |
  What are bad controls?
author:
  - name: Orkhan Sariyev
    url: {}
date: 2024-06-06
preview: effect.png
output:
  distill::distill_article:
    self_contained: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r, libraries, include=FALSE}
library(dagitty)
library(ggdag)
library(ggplot2)
theme_set(theme_dag_blank())
```

Many of us are control freaks. Most likely, you are also one of us if you have decided to read this blog. Applied researchers or those aiming to become one, especially the very young ones working with observational data, are keen to control for variables that they well relate to the outcome or exposure. Indeed, to be able to claim causality, omit the omitted variable bias, we are often motivated to control for variables that feel very "close" to our variables of interest. However, we do have a big problem here. You have heard many times: correlation is not causation. First, it is important to understand the three sources of association:

1.  **Confounder or common cause** means that exposure (X) and outcome (Y) share a common cause (Z). This is visualized in Figure `@ref(fig:confounder)`. Z affects X and Y, and introduces a non-causal association (induce spurious associations) between X and Y. In this cases, we have learned that we must control for Z.  Here, controlling or conditioning on Z means that we block the spurious association and identify the causal effect of X on Y. Thus, Z is a good (i.e., necessary) control here.   

```{r confounder, out.width="70%", fig.cap = "Confounder",fig.align='center'}
dag <- dagify(
  y~z,
  y~x,
  x~z
)
ggdag_classic(dag, text_col = "blue") + theme_dag_blank()+ labs(title = "Confounder")
```
2.  **Collider** means that exposure (X) and outcome (Y) share a common effect (Z). This is visualized in Figure `@ref(fig:collider)`. X and Y, both affect Z. Unlike the previous scenario, X and Y having an effect on Z does not introduce association. In this case, our results would be biased  if we control for Z; we would induce a non-causal association. Thus, Z is a bad control here.  

```{r collider, out.width="70%", fig.cap = "Collider", fig.align='center'}
dag <- dagify(
  z~y,
  z~x,
  y~x
)
ggdag_classic(dag, text_col = "blue") + theme_dag_blank()+ labs(title = "Collider")

```
3. **Mediator** means that exposure (X) affects outcome of interest (Y) through the mediator (Z). If we control for Z, we block the association. Figure  `@ref(fig:mediator)` visualizes a chain. Controlling for Z on this causal pathway stops the flow of association and results in *overcontrol bias*. Thus, Z is again a bad control. 

***CAVEAT!!!*** Here, I assume that the interest lies in the total effect of X on Y. Conditioning on Z is relevant if the researcher is interested in controlled direct effect (CDE). This, we commonly encounter in mediation analyses.

```{r mediator, out.width="70%",fig.cap = "Mediator", fig.align='center'}
dag <- dagify(
  y~z,
  z~x
)
ggdag_classic(dag, text_col = "blue") + theme_dag_blank()+ labs(title = "Mediator")
```
